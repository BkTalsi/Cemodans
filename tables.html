<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Results - Rez Sheet</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            text-align: center;
        }
        th, td {
            border: 1px solid #333;
            padding: 10px;
            font-size: 1.2em;
        }
        .header-cell {
            background-color: #004d4d;
            color: white;
        }
        .points-cell {
            background-color: #c2a83e;
            color: #000;
            font-weight: bold;
        }
        .team-name-cell {
            background-color: #004d4d;
            color: white;
        }
    </style>
    <script>
        const sheetID = "1TpX7oRId-a7WD1PFH7aJoR9y6ConYYIWwWOYwMOmO-k";
        const gid = "187862000";
        const apiURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&gid=${gid}`;

        async function fetchResults() {
            try {
                const response = await fetch(apiURL);
                const text = await response.text();
                const jsonText = text.match(/\{.*\}/s)?.[0];
                if (!jsonText) return;
                const data = JSON.parse(jsonText);
                const rows = data.table.rows;

                const results = {};
                rows.forEach(row => {
                    const matchID = row.c[0]?.v;
                    const result = row.c[8]?.v;
                    if (matchID && result) {
                        results[matchID] = result;
                    }
                });

                document.querySelectorAll('[data-match-id]').forEach(cell => {
                    const matchID = cell.getAttribute('data-match-id');
                    if (results[matchID]) {
                        cell.textContent = results[matchID];
                    }
                });

            } catch (error) {
                console.error("Error fetching data:", error);
            }
        }

        window.onload = fetchResults;
    </script>
</head>
<body class="bg-light">
    <div class="container mt-4">
        <h2 class="text-center mb-4">Talsi 2025 - Results Matrix</h2>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th class="header-cell"></th>
                    <th class="header-cell">TALSI</th>
                    <th class="header-cell">JŪRMALA</th>
                    <th class="header-cell">SALACGRĪVA</th>
                    <th class="header-cell">SIGULDA</th>
                    <th class="points-cell">PUNKTI</th>
                    <th class="points-cell">VIETA</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="team-name-cell">TALSI</td>
                    <td></td>
                    <td data-match-id="1"></td>
                    <td data-match-id="2"></td>
                    <td data-match-id="3"></td>
                    <td data-match-id="20"></td>
                    <td data-match-id="21"></td>
                </tr>
                <tr>
                    <td class="team-name-cell">JŪRMALA</td>
                    <td data-match-id="4"></td>
                    <td></td>
                    <td data-match-id="5"></td>
                    <td data-match-id="6"></td>
                    <td data-match-id="22"></td>
                    <td data-match-id="23"></td>
                </tr>
                <tr>
                    <td class="team-name-cell">SALACGRĪVA</td>
                    <td data-match-id="7"></td>
                    <td data-match-id="8"></td>
                    <td></td>
                    <td data-match-id="9"></td>
                    <td data-match-id="24"></td>
                    <td data-match-id="25"></td>
                </tr>
                <tr>
                    <td class="team-name-cell">SIGULDA</td>
                    <td data-match-id="10"></td>
                    <td data-match-id="11"></td>
                    <td data-match-id="12"></td>
                    <td></td>
                    <td data-match-id="26"></td>
                    <td data-match-id="27"></td>
                </tr>
            </tbody>
        </table>
    </div>
</body>
</html>
